<!DOCTYPE html><html lang="en"><head><link rel="icon" href="img/atom.ico"><title>Leucippus Home</title>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body {text-align:left;
	background-color:LightSteelBlue;
	margin-left: 52px;
	} 
pre {text-align:left;
		background-color:AliceBlue;
		padding: 9px;
		color:Navy} 
	img {width:98% }
	table {width:98%;
	table-layout:fixed;	
	margin:0 auto;
	background-color:Snow;	
	display: table;} 
td {border:1px solid Snow;background-color:White;word-wrap:break-word;}
.collapsible {
  background-color: cornflowerblue;
  color: AliceBlue;
  cursor: pointer;
  padding: 18px;
  width: 100%;
  border: none;
  text-align: left;
  outline: none;
  font-size: 15px;
}

.active, .collapsible:hover {
  background-color: DeepSkyBlue;
}

.content {
  padding: 0 18px;
  display: none;
  overflow: hidden;
  background-color: #f1f1f1;
}
a:link{color:MistyRose;}
a:visited {color:MistyRose;}
a:hover {color:white;}
a.change_link_color:link{color: black;}
a.change_link_color:visited{color: DarkSlateBlue;}
a.change_link_color:hover{color: Navy;}
</style>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-HBH4HKT0NM"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-HBH4HKT0NM');
</script>
</head>
<body>

<hr/>
<h1>
<div style="background-color:black;padding:10px">
<font color="DC143C">Leu</font><font color="AliceBlue">cip</font><font color="DC143C">pus</font>
<img style="width:25px;border:2px;" src="img/atom.ico" alt="Leucippus Atom">
<font color="AliceBlue">Atomic </font><font color="Crimson">Density </font><font color="AliceBlue">Explorer</font>
</div>
</h1>
<p style="background-color:Crimson;margin:5px;padding:5px;color:AliceBlue;">
   <a href='Leucippus.html' title='Home' target='_self'>PhD Home</a>
 ~  <a href='Peaks.html' title='Peaks' target='_self'>Peaks Explorer</a>
 ~  <a href='Slices.html' title='Slices' target='_self'>Local Maps</a>
 ~  <a href='Geometry.html' title='Geometry' target='_self'>Geometry</a>
 ~  <a href='InputPeaks.html' title='Upload' target='_self'>User Uploads</a>
 ~  <a href='Documentation.html' title='Docs' target='_self'>About</a>
~ <a href='https://www.bbk.ac.uk/departments/biology/' title='Birkbeck' target='_blank'>Birkbeck Biology</a>
</p>

<hr/>
<p>
<h3>PhD project: <font color="DC143C">Leu</font>cip<font color="DC143C">pus</font> - Atomic <font color="DC143C">Density</font> Explorer</h3>
</p>
<hr/>
<h3>Leucippus Summary</h3>
<p>
This PhD project is exploring ultrahigh-resolution electron density. The projects made available here are side-ouputs from my PhD project, written to assist me in my research and remain under active development.The utilities are designed to explore atoms and bonds through electron density topology.
<br/><br/>The webpages interface with a C++ program analysing and calculating maps from users or ccp4 and synthetic density and topology.
<i>The code will be open source when out of dev</i>
<br/>
</p>
<table style="background-color:lightsteelblue;color:black;border:2px lightsteelblue;">
<tr style="background-color:lightsteelblue;border:2px lightsteelblue;">
<td style="background-color:lightsteelblue;border:2px lightsteelblue">
<img style="width:99%;border:2px lightsteelblue;" src="img/4rek1.png" alt="View Peaks">
</td>
<td style="background-color:lightsteelblue;border:2px lightsteelblue">
<img style="width:99%;border:2px lightsteelblue;" src="img/4rek2.png" alt="View Peaks">
</td>
<td style="background-color:lightsteelblue;border:2px lightsteelblue">
<img style="width:99%;border:2px lightsteelblue;" src="img/4rek3.png" alt="View Peaks">
</td>
<td style="background-color:lightsteelblue;border:2px lightsteelblue">
<img style="width:99%;border:2px lightsteelblue;" src="img/4rek4.png" alt="View Peaks">
</td>

<td style="background-color:lightsteelblue;border:2px lightsteelblue">
<img style="width:99%;border:2px lightsteelblue;" src="img/6q531.png" alt="View Peaks">
</td>

<td style="background-color:lightsteelblue;border:2px lightsteelblue">
<img style="width:99%;border:2px lightsteelblue;" src="img/6q532.png" alt="View Peaks">
</td>

<td style="background-color:lightsteelblue;border:2px lightsteelblue">
<img style="width:99%;border:2px lightsteelblue;" src="img/6q53den.png" alt="View Peaks">
</td>
<td style="background-color:lightsteelblue;border:2px lightsteelblue">
<img style="width:99%;border:2px lightsteelblue;" src="img/6q53atoms.png" alt="View Peaks">
</td>
</tr>
</table>

<hr/>
<h3>Documentation and Help</h3>

<button type="button" class="collapsible">Peaks Exploration</button>
<div class="content">
<p>
The Peaks Explorer examines electron density maps for peaks, returning the peaks in descending order (to a maximum of 999 for the pdb file format).</br>
<h3>Inputs</h3>
<li><b>Interpolation Method</b></li>
Nearest Neighbour returns peaks directly from the input matrix, B-Spline interpolates the electron density at a 5th degree b-spline (Thevenaz 2000). 
These interpoolation methods are used for the electron density returned at atom positions too.
The algorithm to find peaks has a numerical cap for efficiency.

<br/><br/><li><b>Fo and Fc Numbers</b></li>
By convention, the ccp4 matrix is 2Fo-Fc and the diff matrix is Fo-Fc. 
You can have any combination of Fos and Fcs you want (unless you uploaded your own file in which case it will use that only).
Note that the peaks has an efficiency check using the mean value, so deviating from anything much different to a sum of 1 will be problematic for the peaks 
(ask me if yuo want to do that, it will be fine for visualisation of the density contour slices).

<h3>Available Results</h3>
<li><b>1) Peaks visual projection to 3 planes</b></li>
The density peaks are visualised with a scatter plot in the XY and Yz and zx planes, with the density as a hue, with the highest density sorted to the top.
<br/><br/><li><b>2) Peaks data in pseudo-pdb file</b></li>
The peaks are saved in a coordinate file of pdb format, extension ent, which can be viewed in either Chimera or Coot (etc).n They use some pseudo codes for identification, with the atom type of H.
<br/><code>HETATM    1 PK   DEN P   1      -8.169  18.142  13.609  1.00 58.26           H  
<br/>HETATM    2 PK   LAP P   1      -8.169  18.142  13.609  1.00103.16           H  </code>
<br/>PK is a made up atom type, P is the chain as it is usually not occupied, DEN are the peaks found as density maxima, LAP are the peaks found using the laplacian minima. The bfactor is replaced with the density/laplacian values respectively
(see Figure 1).
<table><tr>
<td>
<img style="width:260px;border:2px;" src="img/peaks.png" alt="View Peaks">
<br/><i>Figure 1: Peaks (blue-green tictacs) and structure 1ejg<i>
</td>
<td>
<img style="width:260px;border:2px;" src="img/chimeraAndPeaks.png" alt="View Peaks">
<br/><i>Figure 2: Structure 1ejg compared with adjusted peaks<i>
</td>
<td>
<i>Molecular graphics and analyses performed with UCSF Chimera, developed by the Resource for Biocomputing, Visualization, and Informatics at the University of California, San Francisco, with support from NIH P41-GM103311.</i>
</td>
</tr></table>

<br/>With a mix of shading, zoning and transparency they can be usefully loaded, eg in Chimera as above, where the tictacs are the density and laplacian peaks seen together at very slightly different points, green is DEN, blue is LAP (this is an area of research).
<br/><br/><li><b>3) Peaks info as html grid</b></li>
This has the density peaks (not laplacian) listed from greatest, as an html scriollable grid. 
Of particular use here is the column which shows the nearest atom from the pdb file within 1&#8491;
<br/><br/><li><b>4) Peaks visual project, atoms only (unit cell)</b></li>
Another projection of peaks onto the xy, yz and zx planes, this time not the entire electron density matrix, but only those peaks within 1&#8491; of a peak. Roughly this shows the unit cell, though not exactly.
<br/><br/><li><b>5) Density visual projection, all atoms</b></li>
No peaks at all now, and this is a different run through of the executable, this time we simply project to the xy, yz and zx planes the density of all the atoms in the pdb file. 
This should look very similar to the peaks for ultrahigh-res structures, very much less so for medium to low res structures.
<br/><br/><li><b>6) Atoms visualised on AtomNo</b></li>
Another view of atoms on the plane, this time visualised on AtomNo purely to give help disentangling the protein structure mentally.
<br/><br/><li><b>7) Create density adjusted pdb file</b></li>
For each atom of full occupancy, it looks for the nearest density peak and replaces with those coordinates - if there is not one close by it is removed
(see Figure 2).
<br/><br/><li><b>8) Create laplacian adjusted pdb file</b></li>
For each atom of full occupancy, it looks for the nearest laplacian minimum peak and replaces with those coordinates - if there is not one close by it is removed.
</p>
</div>
<hr/>
<button type="button" class="collapsible">Local Maps</button>
<div class="content">
<p>
The local maps show planar slices of electron density maps  visualised like a contour map. 
</br>
<h3>Inputs</h3>
<li><b>Interpolation Method</b></li>
Nearest Neighbour returns the density value at the nearest point on the matrix, B-Spline interpolates the electron density at a 5th degree b-spline (Thevenaz 2000). 

<br/><br/><li><b>Fo and Fc Numbers</b></li>
By convention, the ccp4 matrix is 2Fo-Fc and the diff matrix is Fo-Fc. 
You can have any combination of Fos and Fcs you want (unless you uploaded your own file in which case it will use that only).
<br/>If you choose 0,0 Leucippus will calculate a simulated synthetic IAM density from the pdb coordinates instead (it takes longer, consider reducing width and granularity).

<br/><br/><li><b>3 points for a plane</b></li>
A plane must have and can only have 3 points to define it. The centre will be in the centre, the linear point will be upwards, and the planar opint will be anywhere on the plane on the right hand side.
It is possible that the linear and planar points are not visible if the size is too small.

<br/><br/><li><b>Image size</b></li>
The image will be the width specified, and will have sampled points at every gap, so the smaller the gap the smoother the image and the longer it will take.
Start with a reasonable size gap until you have the image you want, then you can perfect it.

<h3>Results</h3>
<p>The 3 results views have the same orientation constructed with the centre point in the middle, 
the linear point vertically above, the planar point to the right. Small yellow dots are placed at these 3 input positions.
<li><b>Density</b></li>
This is a visualisation of the density directly, interpolated as chosen (see Figure 3). 
<br/>To assist the visualisation the contours have been set to a cap of 50% - everything above 50% of the maximum value is the same and black in the image.. This enables lower contour density to be visible.
<br/><br/><li><b>Radiant</b></li>
This is properly known as the L1 Norm of Del, referred to by me as the radiant for being a kind of gradient (sum of absolute values of 1st partial derivatives) 
and because the coordinate grid lines radiate out of the maxima positions (which is not necessarily a popular view but I find it useful for identifying maxima)
(see Figure 4).
<br/>No cap is necessary for the radiant.
<br/><br/><li><b>Laplacian</b></li>
The second derivative, either the sum of the 2nd partial derivatives, or the sum of the eigenvalues, they are equivalent
(see Figure 5).
<br/>No cap is used.
<table>
<tr>
<td style="text-align:left;color:Crimson;">Density</td>
<td style="text-align:left;color:Crimson;">Radiant</td>
<td style="text-align:left;color:Crimson;">Laplacian</td>
</tr>
<tr>
<td>
<img style="width:80%;border:2px;" src="img/densityslice.png" alt="Density">
<br/><i>Figure 3: Density contour slice from Leucippus 1ejg<i>
</td>
<td>
<img style="width:80%;border:2px;" src="img/radiantslice.png" alt="Radiant">
<br/><i>Figure 4: Radiant slice from Leucippus<i>
</td>
<td>
<img style="width:80%;border:2px;" src="img/laplacianslice.png" alt="Lalacian">
<br/><i>Figure 5: Laplacian slice from Leucippus<i>
</td>
</tr>
</table>
</p>
</div>

<hr/>
<button type="button" class="collapsible">Geometry</button>
<div class="content">
 <p>  
A geometry comparison can be done between 2 pdbs, it can be any whether from the pdb or user uploaded - the idea is to facilitate comparison of pdb structures with density adjusted pdb structures, but it can be used to compare say 2 different crambin structures (which are the defaults).
<br/> Enter 2 pdbs and 3 geos. Geos can be any distance, angle or dihedral described by the atom code and a colon, e.g.
<li>N:CA for the distance between backbone N and CA</li>
<li>N:CA:C for the backbone angle, which also has an alias TAU</li>
<li>N:CA:C:N+1 or PSI to descibe a dihedral</li>
<li>You can define anything, eg CA-2:C:CA+2 if you want</li>
<li>Instead of a Geo you can alternatively use bfactor</li>
</br>3 plots are returned on 5 rows as follows:
<li>Row1: Histograms for pdbA of each geo</li>
<li>Row2: Histograms for pdbB of each geo</li>
<li>Row3: Scatter plots for pdbA of geoA against geoB with hue geoC, then geoB vs geoC hue geoA, finally geoC vs geoA hue geoB</li>
<li>Row4: Scatter plots for pdbB of geoA against geoB with hue geoC, then geoB vs geoC hue geoA, finally geoC vs geoA hue geoB</li>
<li>Row5: Scatter plots for pdbA and pdbB of geoA against geoB, then geoB vs geoC, finally geoC vs geoA the hue for all being the pdbCode</li>

<table>
<tr><td style="text-align:center;color:Crimson;">Example of a Histogram</td>
<td style="text-align:center;color:Crimson;">Example of scatter for one pdb</td>
<td style="text-align:center;color:Crimson;">Scatter comparison for pdbs</td></tr>
<tr>
<td>
<img style="width:95%;border:2px;" src="img/Geom1.png" alt="Lalacian">
</td>
<td>
<img style="width:95%;border:2px;" src="img/Geom2.png" alt="Lalacian">
</td>
<td>
<img style="width:95%;border:2px;" src="img/Geom3.png" alt="Lalacian">
</td>
</tr></table>
 
</div>

<hr/>
<button type="button" class="collapsible">User Uploads</button>
<div class="content">
 <p>  
You can upload your own ccp4 and pdb files to analyse. You are responsible for them being in the correct format of the standard ccp4 or pdb formats - I can't test them 
(well, if you have any difficulty I can debug them if you get in touch).
</br>
<h3>Inputs</h3>
<li><b>4 character code</b></li>
This is the name by which your data will be referred (it could be any length actually), not the file name.

<br/><br/><li><b>Ccp4 File</b></li>
It must be in the <a class="change_link_color" href="https://www.ccpem.ac.uk/mrc_format/mrc2014.php" title="Ccp4" target="_blank">ccp4 format</a>

<br/><br/><li><b>Pdb File</b></li>
It must be in the <a class="change_link_color" href="https://www.wwpdb.org/documentation/file-format-content/format33/v3.3.html" title="Pdb" target="_blank">pdb format</a>
<br/>However, you don't have to enter a pdb file, it is used for distance between atoms and peaks comparison. If you don't want to use one, you need to enter a dummy pdb file, it needs to be at least 2 characters long (it won't allow you to upload an empty file).
<br/>In this case, when it looks for nearby atoms, it just won't find any.  
</p>

</div>
<hr/>
<h3>Acknowledgements</h3>

<p><b>Supervisor: </b>
<a class="change_link_color" href="http://people.cryst.bbk.ac.uk/~ubcg66a/" title="MAW" target="_blank">Mark A. Williams</a> Director, ISMB Biophysics Centre

</p>

<hr/>
<div style="background-color:Silver;padding:3px">
<h3>References</h3>
<li>Afonine, Pavel V., Vladimir Y. Lunin, Nicolas Muzet, and Alexandre Urzhumtsev. ‘On the Possibility of the Observation of Valence Electron Density for Individual Bonds in Proteins in Conventional Difference Maps’. Acta Crystallographica Section D Biological Crystallography 60, no. 2 (1 February 2004): 260–74. https://doi.org/10.1107/S0907444903026209.
</li>
<li>Hunter,J. D., "Matplotlib: A 2D Graphics Environment", Computing in Science & Engineering, vol. 9, no. 3, pp. 90-95, 2007.
</li>
<li>Jelsch, C., Teeter, M. M., Lamzin, V., Pichon-Pesme, V., Blessing, R. H., &#38; Lecomte, C. (2000). Accurate protein crystallography at ultra-high resolution: Valence electron distribution in crambin. <i>Proceedings of the National Academy of Sciences of the United States of America</i>, <i>97</i>(7), 3171–3176. https://doi.org/10.1073/pnas.97.7.3171</li>
<li>Pettersen EF, Goddard TD, Huang CC, Couch GS, Greenblatt DM, Meng EC, Ferrin TE. 'UCSF Chimera--a visualization system for exploratory research and analysis'. J Comput Chem. 2004 Oct;25(13):1605-12.</li>
<li>Thévenaz, P., Blu, T., &#38; Unser, M. (2000). Interpolation Revisited. <i>IEEE TRANSACTIONS ON MEDICAL IMAGING</i>, <i>19</i>(7), 739.</li>
<li>Yao, S., &#38; Moseley, H. N. B. (2019). <i>A chemical interpretation of protein electron density maps in the worldwide protein data bank</i></li>
<h3>Web Resources</h3>
<li><a class="change_link_color" href='https://www.phenix-online.org/presentations/latest/pavel_maps_2.pdf'' title='PavelAfonine' target='_blank'>Pavel Afonine: Some Facts About Maps</a></li>
<li><a class="change_link_color" href='https://gemmi.readthedocs.io/en/latest/' title='Gemmi' target='_blank'>CCP4 Project GEMMI: library for structural biology</a></li>
<li><a class="change_link_color" href='https://chem.libretexts.org/Bookshelves/Inorganic_Chemistry/Modules_and_Websites_(Inorganic_Chemistry)/Crystallography/X-rays/CromerMann_coefficients'' title='Libre' target='_blank'>LibreTexts: Cromer-Mann coefficients</a></li>

</div>

<hr/>
<p style="background-color:Crimson;margin:5px;padding:5px;color:AliceBlue;">
Created by: <a href = "mailto:ralcra01@student.bbk.ac.uk" > Rachel Alcraft </a >
 ~ Home page: <a href="https://student.cryst.bbk.ac.uk/~ab002/Leucippus.html" title="Leucippus" target="_self">Leucippus</a>
 ~ Supervisor: <a href="http://people.cryst.bbk.ac.uk/~ubcg66a/" title="MAW" target="_blank">Mark A. Williams</a>
 ~ Birkbeck, University of London, 2021
</p>
</div>

<script>
var coll = document.getElementsByClassName("collapsible");
var i;

for (i = 0; i < coll.length; i++) {
  coll[i].addEventListener("click", function() {
    this.classList.toggle("active");
    var content = this.nextElementSibling;
    if (content.style.display === "block") {
      content.style.display = "none";
    } else {
      content.style.display = "block";
    }
  });
}
</script>

</body>
</html>


